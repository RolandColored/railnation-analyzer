<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="X-UA-Compatible" content="requiresActiveX=true" />
	<title>Rail Nation</title>
	<link rel="shortcut icon" href="favicon.ico" />
	<meta name="language" content="en" />
	<meta name="description" content="" />
	<meta name="keywords" content="" />

		<script type="text/javascript">
    var thisSwf = 'preloader';
    var offsetHorScrollbar = 0;
    var offsetVerScrollbar = 0;
    var browserInnerWidth = 0;
    var browserInnerHeight = 0;
    var offsetLinkBox = 00;
    var initialFlashPlayerWidth = 0;
    var initialFlashPlayerHeight = 0;

    function getID( swfID )
    {
        if(navigator.appName.indexOf("Microsoft") != -1)
        {
           return window[swfID];
        }
        else
        {
           return document[swfID];
        }
    }

    function updateWindowSize()
    {
		var innerWidth = getInnerBrowserWidth();
		var innerHeight = getInnerBrowserHeight();

		if(thisSwf)
		{
			getID(thisSwf).setAttribute('width', innerWidth);
			getID(thisSwf).setAttribute('height', innerHeight);
		}
    }

    function getPartnerbarHeight()
    {
        res = 0;

        var partnerBar = document.getElementById("branding");

        if ( partnerBar ) {
            if (partnerBar.innerHeight != undefined)
                res = partnerBar.innerHeight;
            else
                res = partnerBar.clientHeight;
        }

        return res;
    }
		
    function getInnerBrowserWidth()
    {
        if( typeof( window.innerWidth ) == 'number' )
        {
            //Non-IE
            browserInnerWidth = window.innerWidth - offsetHorScrollbar;
        }
        else if( document.documentElement && ( document.documentElement.clientWidth || document.documentElement.clientHeight ) )
        {
            //IE 6+ in 'standards compliant mode'
            browserInnerWidth = document.documentElement.clientWidth - offsetHorScrollbar;
        }
        else if( document.body && ( document.body.clientWidth || document.body.clientHeight ) )
        {
            //IE 4 compatible
            browserInnerWidth = document.body.clientWidth - offsetHorScrollbar;
        }

        return browserInnerWidth;
    }
		
    function getInnerBrowserHeight()
    {
        if(typeof partnerBarHeight === 'number')
        {
            var pbh = partnerBarHeight;
        }
        else
        {
            var pbh = getPartnerbarHeight();
        }

        if( typeof( window.innerHeight ) == 'number' )
        {
            //Non-IE
            browserInnerHeight = window.innerHeight - offsetVerScrollbar - offsetLinkBox - pbh;
        }
        else if( document.documentElement && document.documentElement.clientHeight  )
        {
            //IE 6+ in 'standards compliant mode'
            browserInnerHeight = document.documentElement.clientHeight - offsetVerScrollbar - offsetLinkBox - pbh;
        }
        else if( document.body && document.body.clientHeight )
        {
            //IE 4 compatible
            browserInnerHeight = document.body.clientHeight - offsetVerScrollbar - offsetLinkBox - pbh;
        }

        return browserInnerHeight;
    }
	</script>
	<script src="js/swfobject.js" type="text/javascript"></script>
	<script type="text/javascript">
        function load_swf(swf_name, assets_dir, sku, key, gs, chatserver, chatserver_port, chatserver_ping, chatserver_pingtimeout, chat_world, support, language, adcode, origin)
        {
			initialFlashPlayerHeight = getInnerBrowserHeight();
			
            var flashvars = {
                sku: sku,
                key:   key,
        		gameServerUrl: gs,
                chatServer: chatserver,
                chatServerPort: chatserver_port,
                chatServerPing: chatserver_ping,
                chatServerPingTimeout: chatserver_pingtimeout,
                chatWorld: chat_world,
                support: support,
                language: language,
                adcode: adcode,
                origin: origin
            };
            var params = {
                menu: "false",
                scale: "noScale",
                allowFullscreen: "true",
                allowScriptAccess: "always",
                allowFullScreenInteractive: "true",
                bgcolor: "#000000",
                wmode: "gpu",
                base: assets_dir
            };
            var attributes = {
                id:swf_name,
                wmode: "gpu"
            };
            swfobject.embedSWF(assets_dir + "/" + swf_name + ".swf", "altContent", "100%", initialFlashPlayerHeight, "10.0.0", "expressInstall.swf", flashvars, params, attributes);
        }
        // load and embed swf with game.js
        load_swf(
                "preloader",
                "assets/ea24d4af2c566004782f750f940615e5",
                "ru-RU",
                "4f65bf4aa7d0404263a6e3ed90c54017",
                "http://s3.railnation.ru/web/rpc/",
                "146.0.8.195",
                "5476",
                "10000",
                "120000",
                "s3.railnation.ru",
                "0",
                "ru-RU",
                "0",
                "xx/XX"
        );
	</script>
	<link href="css/game.css" rel="stylesheet" type="text/css" />
	<script type="text/javascript">

            var currentlyOpenShopFrame = null;

            function showPaymentShop(posX, posY, width, height, srcUrl) {
                //alert("should open payment shop frame now...");

                if(currentlyOpenShopFrame == null) {
                    shopFrame = document.createElement("IFRAME");
                } else {
                    shopFrame = currentlyOpenShopFrame;
                }
				
				posY = posY + getPartnerbarHeight();

                shopFrame.setAttribute("src", srcUrl);
                shopFrame.style.position = "absolute";
                shopFrame.style.left = posX+"px";
                shopFrame.style.top = posY+"px";
                shopFrame.style.width = width+"px";
                shopFrame.style.height = height+"px";
                shopFrame.style.padding = 0;
                shopFrame.style.margin = 0;
                shopFrame.style.border = "none";
                currentlyOpenShopFrame = shopFrame;

                document.body.appendChild(currentlyOpenShopFrame);
            }
			
			function movePaymentShop(posX, posY) {
                //alert("should open payment shop frame now...");

                if(currentlyOpenShopFrame != null) {
					posY = posY + getPartnerbarHeight();
					shopFrame.style.position = "absolute";
					shopFrame.style.left = posX+"px";
					shopFrame.style.top = posY+"px";
				}
            }

            function closePaymentShop() {
                document.body.removeChild(currentlyOpenShopFrame);
            }
     
        function popup (name, url, width, height)
        {
             win = window.open(url, name, "width=" + width + ",height=" + height + ",resizable=yes");
             win.focus();
        }
        function addIFrame(params, hash)
        {
            var i = document.createElement("iframe");
            i.setAttribute('id', "tpixeliframe");
            i.style.width = "1px";
            i.style.height = "1px";
            i.style.margin = "0";
            i.style.padding = "0";
            i.setAttribute('src', 'http://iframe.traviangames.com/live?'+params+'&mh='+hash);
            document.getElementsByTagName('body')[0].appendChild(i);
        }
        function addBrandingIFrame(url)
        {
            var i = document.createElement("iframe");
			i.setAttribute('id', "branding");
            i.style.width = "100%";
            i.style.height = "100px";
            i.style.margin = "0";
            i.style.padding = "0";
            i.setAttribute('src', url);
            var body = document.getElementsByTagName('body')[0];
            body.insertBefore(i,  body.childNodes[0]);
            updateWindowSize();
        }
    </script>
</head>
<body onload="updateWindowSize()">
	<div id="altContent">
		<h1>Rail Nation</h1>
		<p>Alternative content</p>
		<p><a href="http://www.adobe.com/go/getflashplayer"><img 
			src="http://www.adobe.com/images/shared/download_buttons/get_flash_player.gif" 
			alt="Get Adobe Flash player" /></a></p>
	</div>
	<script language="javascript">
		window.onresize = updateWindowSize;
	</script>
</body>
</html>
